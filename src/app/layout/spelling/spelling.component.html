<div class="test-container">
  <div class="selected-word">
    <p>{{ selectedWord.split('').join(' . ') }}</p>
  </div>

  <!-- Level Selector -->
  <div class="level-selector">
    <label>
      <input type="radio" name="level" value="1" (change)="setLevel(1)" [checked]="level === 1" /> Level 1
    </label>
    <label>
      <input type="radio" name="level" value="2" (change)="setLevel(2)" [checked]="level === 2" /> Level 2
    </label>
    <label>
      <input type="radio" name="level" value="3" (change)="setLevel(3)" [checked]="level === 3" /> Level 3
    </label>
  </div>

  <!-- Phonetics Toggle -->
  <div class="phonetics-toggle">
    <label>
      <input type="checkbox" [checked]="usePhonetics" (change)="togglePhonetics()">
      Use Phonetics
    </label>
  </div>

  <!-- Spelling Section -->
  <div class="section">
    <h3>Spelling</h3>
    <div class="word-container">
      <ng-container *ngIf="section1Array$ | async as section1Array">
        <div *ngFor="let word of section1Array" class="word-item">
          <div class="word-blocks">
            <ng-container *ngFor="let block of getWordBlocks(word); let i = index">
              <ng-container *ngIf="block !== ''">
                <span class="letter-block">{{ block }}</span>
              </ng-container>
              <ng-container *ngIf="block === ''">
                <input #userInput type="text" maxlength="1"
                  [class.correct]="userInputs.get(word)?.has(missingLettersMap.get(word)?.letters[i] || '')"
                  [attr.data-word]="word"
                  class="letter-input"
                  (input)="checkAnswer($event, word)" />
              </ng-container>
            </ng-container>
          </div>
          <div class="word-actions">
            <button (click)="playWordAudio(word)">{{ usePhonetics ? 'Play Phonetics' : 'Play Word' }}</button>
            <button *ngIf="attemptCount >= 5" (click)="hint(word)">Hint</button>
          </div>
          <div *ngIf="allLettersEntered(word)" class="feedback correct">
            <p>Correct!</p>
          </div>
        </div>
      </ng-container>
    </div>
  </div>
</div>
